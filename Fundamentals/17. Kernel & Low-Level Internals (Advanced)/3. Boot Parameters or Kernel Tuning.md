***
**Boot Parameters / Kernel Tuning:** `grub2-mkconfig`, `update-grub`, `sysctl -w`, `kernel.org boot parameters`, `cat /proc/cmdline`
***
***
# `grub2-mkconfig` Command in Linux

## Overview

The `grub2-mkconfig` command in Linux is used to generate a new GRUB2 configuration file based on the scripts and settings found in `/etc/default/grub` and the `/etc/grub.d/` directory. This command is essential when updating the GRUB bootloader configuration after changes such as adding kernels, changing boot parameters, or modifying menu entries.

## Syntax

```
grub2-mkconfig [OPTION]...
```

By default, the command writes output to standard output, so it is often redirected to the GRUB configuration file, commonly `/boot/grub2/grub.cfg` on BIOS systems or `/boot/efi/EFI/<distro>/grub.cfg` on UEFI systems.

## Common Usage

Generate GRUB configuration and write it to the default file:

```
grub2-mkconfig -o /boot/grub2/grub.cfg
```

On UEFI systems:

```
grub2-mkconfig -o /boot/efi/EFI/fedora/grub.cfg
```

## Options

- `-o, --output FILE` : Write the GRUB configuration to the specified file.
    
- `-d, --directory DIR` : Use the specified GRUB directory instead of the default.
    
- `-p, --prefix DIR` : Set the GRUB prefix directory.
    
- `-q, --quiet` : Suppress output messages.
    
- `--help` : Display help information and exit.
    
- `--version` : Show the version of grub2-mkconfig.
    

## Examples

### 1\. Generate GRUB2 configuration for BIOS system

```
grub2-mkconfig -o /boot/grub2/grub.cfg
```

This scans `/etc/default/grub` and `/etc/grub.d/` scripts and writes the resulting configuration to `/boot/grub2/grub.cfg`.

### 2\. Generate GRUB2 configuration for UEFI system

```
grub2-mkconfig -o /boot/efi/EFI/fedora/grub.cfg
```

This writes the configuration suitable for UEFI boot to the specified location.

### 3\. Use a custom GRUB directory

```
grub2-mkconfig -d /custom/grub/directory -o /boot/grub2/grub.cfg
```

This tells `grub2-mkconfig` to look for scripts and modules in `/custom/grub/directory`.

### 4\. Generate configuration quietly

```
grub2-mkconfig -o /boot/grub2/grub.cfg -q
```

Suppresses informational messages and only outputs errors if present.

### 5\. Display help and version

```
grub2-mkconfig --help
```

```
grub2-mkconfig --version
```

These commands provide usage instructions and the current version of the command.

## Notes

- Always run `grub2-mkconfig` as root or using `sudo` to ensure proper access to system directories.
    
- After generating a new GRUB configuration, reboot the system to apply changes.
    
- Avoid editing `/boot/grub2/grub.cfg` manually; always regenerate it using `grub2-mkconfig`.
    
- Custom scripts in `/etc/grub.d/` should be executable and properly formatted to be included in the configuration.
    

* * *

* * *

# `update-grub` Command in Linux

## Overview

The `update-grub` command in Linux is a script used to automatically generate a new GRUB bootloader configuration file. It is often a wrapper around `grub-mkconfig` or `grub2-mkconfig` depending on the Linux distribution. This command is commonly used on Debian and Ubuntu systems to update GRUB after installing new kernels, changing boot parameters, or modifying `/etc/default/grub` settings.

## Syntax

```
update-grub [OPTION]...
```

By default, `update-grub` scans `/etc/default/grub` and `/etc/grub.d/` and writes the generated configuration to `/boot/grub/grub.cfg`.

## Options

- `-h, --help` : Display help information and exit.
    
- `-v, --version` : Show the version of `update-grub`.
    

## Behavior

`update-grub` typically executes the following steps:

1.  Detect installed operating systems using `os-prober`.
    
2.  Generate GRUB configuration based on `/etc/default/grub` and `/etc/grub.d/` scripts.
    
3.  Write the resulting configuration to `/boot/grub/grub.cfg`.
    

## Examples

### 1\. Update GRUB configuration

```
sudo update-grub
```

This command scans the system for kernels and operating systems, then updates `/boot/grub/grub.cfg` with the latest boot menu entries.

### 2\. Display detailed output during update

```
sudo update-grub -v
```

Provides verbose output showing detected kernels and OS entries.

### 3\. Display help information

```
update-grub --help
```

Shows usage instructions and available options.

### 4\. Update GRUB after installing a new kernel

After installing a new Linux kernel, run:

```
sudo update-grub
```

This ensures the new kernel appears in the boot menu.

### 5\. Custom configuration path (advanced)

While not standard, `update-grub` can pass options to `grub-mkconfig` if required, for example:

```
sudo update-grub --output=/boot/grub/custom_grub.cfg
```

This writes the GRUB configuration to a custom file instead of the default location.

## Notes

- `update-grub` must be run with root privileges using `sudo`.
    
- It is the preferred method to regenerate `/boot/grub/grub.cfg` on Debian-based distributions.
    
- For non-Debian distributions, use `grub2-mkconfig` instead.
    
- Manual edits to `/boot/grub/grub.cfg` are discouraged; use `update-grub` or `grub-mkconfig` for all changes.
    

* * *

* * *

# `sysctl -w` Command in Linux

## Overview

The `sysctl -w` command in Linux is used to write or modify kernel parameters at runtime. These parameters control various aspects of the kernel's behavior, including networking, memory management, and security settings. Using `sysctl -w` allows administrators to temporarily adjust system behavior without editing configuration files.

## Syntax

```
sysctl -w VARIABLE=VALUE
```

- `VARIABLE` : The kernel parameter to modify, typically found under `/proc/sys/`.
    
- `VALUE` : The new value to assign to the parameter.
    

## Options

- `-w` : Write or set the value of a kernel parameter.
    
- `-n` : Print only the value without the parameter name.
    
- `-p` : Load sysctl settings from a configuration file (commonly `/etc/sysctl.conf`).
    
- `-e` : Ignore unknown variables and continue processing.
    
- `--help` : Display help information.
    
- `--version` : Show the version of sysctl.
    

## Examples

### 1\. Change maximum number of open files

```
sudo sysctl -w fs.file-max=100000
```

This sets the maximum number of open files to 100000 until the next reboot.

### 2\. Enable IP forwarding

```
sudo sysctl -w net.ipv4.ip_forward=1
```

Allows the system to forward IPv4 packets, commonly used in routing setups.

### 3\. Modify TCP keepalive time

```
sudo sysctl -w net.ipv4.tcp_keepalive_time=600
```

Sets TCP keepalive time to 600 seconds.

### 4\. View only the value when setting a parameter

```
sudo sysctl -n -w net.ipv4.ip_forward=1
```

Prints only the new value without the parameter name.

### 5\. Ignore unknown variables

```
sudo sysctl -e -w net.ipv4.nonexistent_param=1
```

The command continues without error even if the specified parameter does not exist.

### 6\. Persisting changes (advanced)

Changes made with `sysctl -w` are temporary. To make them persistent across reboots, add them to `/etc/sysctl.conf`:

```
echo 'net.ipv4.ip_forward=1' | sudo tee -a /etc/sysctl.conf
sudo sysctl -p
```

## Notes

- `sysctl -w` requires root privileges, typically using `sudo`.
    
- Changes made using `-w` are temporary and reset on reboot.
    
- Use `/etc/sysctl.conf` or files in `/etc/sysctl.d/` for permanent changes.
    
- For a full list of kernel parameters, inspect `/proc/sys/` or use `sysctl -a`.
    

* * *

* * *

# Linux Kernel Boot Parameters

## Overview

Kernel boot parameters are options passed to the Linux kernel at boot time to control its behavior. These parameters can influence hardware configuration, debugging options, security settings, and performance tuning. They are typically specified in the bootloader configuration (GRUB) and are read by the kernel during initialization.

Official documentation for kernel boot parameters can be found at Kernel.org: https://www.kernel.org/doc/html/latest/admin-guide/kernel-parameters.html

## Specifying Boot Parameters

Boot parameters are usually added to the kernel command line in GRUB configuration:

- Temporary (for single boot): Edit the GRUB menu at boot by pressing `e` and appending parameters to the `linux` line.
    
- Persistent: Add parameters in `/etc/default/grub` in the `GRUB_CMDLINE_LINUX` variable and update GRUB configuration.
    

Example for persistent changes:

```
sudo nano /etc/default/grub
# Add parameter to GRUB_CMDLINE_LINUX
GRUB_CMDLINE_LINUX="quiet splash ipv6.disable=1"
sudo update-grub
```

## Common Kernel Boot Parameters

### 1\. Root Filesystem Parameters

- `root=/dev/sda1` : Specifies the root filesystem device.
    
- `ro` : Mount root filesystem as read-only.
    
- `rw` : Mount root filesystem as read-write.
    

### 2\. Hardware Parameters

- `acpi=off` : Disable ACPI (Advanced Configuration and Power Interface).
    
- `noapic` : Disable the Advanced Programmable Interrupt Controller.
    
- `pci=nomsi` : Disable MSI for PCI devices.
    

### 3\. Networking Parameters

- `ip=dhcp` : Use DHCP to configure network interface at boot.
    
- `ipv6.disable=1` : Disable IPv6.
    

### 4\. Debugging and Logging

- `debug` : Enable kernel debugging.
    
- `loglevel=3` : Set kernel log verbosity (0=emergency, 7=debug).
    
- `initcall_debug` : Debug kernel initialization functions.
    

### 5\. Performance Tuning

- `maxcpus=2` : Limit the number of CPUs used.
    
- `nosmp` : Disable Symmetric Multiprocessing.
    
- `sched_debug` : Enable scheduler debugging.
    

### 6\. Security Parameters

- `selinux=0` : Disable SELinux.
    
- `apparmor=0` : Disable AppArmor.
    
- `enforcing=0` : Set SELinux to permissive mode.
    

## Examples

### 1\. Boot with IPv6 disabled and quiet mode

```
GRUB_CMDLINE_LINUX="quiet splash ipv6.disable=1"
sudo update-grub
```

### 2\. Boot with debugging enabled and verbose logging

```
GRUB_CMDLINE_LINUX="debug loglevel=7 initcall_debug"
sudo update-grub
```

### 3\. Boot with only 2 CPUs active

```
GRUB_CMDLINE_LINUX="maxcpus=2"
sudo update-grub
```

### 4\. Boot with SELinux disabled

```
GRUB_CMDLINE_LINUX="selinux=0 enforcing=0"
sudo update-grub
```

## Notes

- Changes made in GRUB configuration require running `update-grub` or `grub2-mkconfig` depending on the distribution.
    
- Temporary kernel boot parameters can be tested by editing the GRUB menu at boot.
    
- Refer to Kernel.org documentation for a complete list of available kernel parameters.
    

* * *

* * *

# `cat /proc/cmdline` in Linux

## Overview

The `cat /proc/cmdline` command in Linux is used to view the kernel command line parameters that were passed to the Linux kernel at boot time. This file contains a single line of text showing all boot parameters set by the bootloader (such as GRUB) for the current kernel.

This command is useful for verifying boot-time kernel parameters, debugging boot issues, or checking system configuration.

## Syntax

```
cat /proc/cmdline
```

- `/proc/cmdline` : A virtual file in the `/proc` filesystem that stores the kernel command line for the currently running kernel.

## Key Points

- The output is a single line containing all parameters passed to the kernel at boot.
    
- It is read-only and cannot be modified directly.
    
- The parameters listed here correspond to what is set in the bootloader configuration (e.g., `/etc/default/grub` for GRUB).
    

## Common Kernel Parameters Seen

- `root=/dev/sda1` : Root filesystem device.
    
- `ro` or `rw` : Read-only or read-write mount options.
    
- `quiet` : Reduce boot messages.
    
- `splash` : Display graphical boot splash.
    
- `ipv6.disable=1` : Disable IPv6 support.
    
- `selinux=0` : Disable SELinux.
    
- `maxcpus=2` : Limit the number of CPUs used.
    

## Examples

### 1\. View current kernel boot parameters

```
cat /proc/cmdline
```

Output example:

```
BOOT_IMAGE=/boot/vmlinuz-5.15.0-50-generic root=/dev/sda1 ro quiet splash vt.handoff=7
```

### 2\. Search for specific boot parameter

Check if IPv6 is disabled:

```
cat /proc/cmdline | grep ipv6.disable
```

### 3\. Verify root filesystem parameter

```
cat /proc/cmdline | grep root
```

### 4\. View parameters in a more readable format (optional)

```
tr ' ' '
' < /proc/cmdline
```

This prints each boot parameter on a separate line.

## Notes

- `/proc/cmdline` is dynamically generated by the kernel at boot and reflects the exact parameters used.
    
- Changes to boot parameters must be made in the bootloader configuration and cannot be applied by editing this file.
    
- It is helpful for troubleshooting boot issues, checking security or networking settings, and verifying system resource limits.
    

* * *

* * *

